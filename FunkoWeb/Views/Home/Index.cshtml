@model IEnumerable<FunkoWeb.Models.Funko>

@{
    ViewData["Title"] = "Listado de Funkos";
}

<div class="text-center mb-5">
    <h1 class="display-4">Mi Colección de Funkos</h1>
    
    <div class="funko-image-fondo">
        <img src="/images/Fondo-Funko.jpeg" alt="Imagen de marca"/>
    </div>
    
    <p class="lead">Gestiona tu colección de figuras Funko Pop</p>
</div>

<div class="container">
    <form asp-action="Buscar" method="get" class="mb-sm-3 text-end d-flex justify-content-end">
        <div class="input-group w-auto">
            <input type="text" 
                   name="texto"
                   class="form-control" 
                   placeholder="Buscar Funko..."
                   aria-label="Buscar Funko">

            <button type="submit" class="btn btn-success">
                <i class="bi bi-search"></i>
            </button>
        </div>
    </form>
    @if (User.IsInRole("Admin"))
    {
        <div class="mb-sm-3 text-end">
            <a asp-action="Crear" class="btn btn-success">
                <i class="bi bi-plus-circle-fill"></i> Nuevo Funko
            </a>
        </div>
    }

    <div class="table-responsive">
        <table class="table table-hover">
            <thead class="table-dark">
            <tr>
                <th><i class="bi bi-image"></i> Imagen</th>
                <th><i class="bi bi-tag"></i> Nombre</th>
                <th><i class="bi bi-currency-dollar"></i> Precio</th>
                <th><i class="bi bi-boxes"></i> Stock</th>
                <th><i class="bi bi-bookmark"></i> Categoría</th>
                <th class="text-center"><i class="bi bi-gear"></i> Acciones</th>
            </tr>
            </thead>
            <tbody>
            @foreach (var funko in Model)
            {
                <tr>
                    <td>
                        <div class="funko-image-wrapper">
                            <img src="@Url.Content(funko.Image)"
                                 alt="@funko.Name" style="width: 100px; height: auto;"
                                 onerror="this.src='/images/default-funko.png';"/>
                        </div>
                    </td>
                    <td class="align-middle">
                        <strong style="color: #667eea;">@funko.Name</strong>
                    </td>
                    <td class="align-middle">
                        <span class="badge bg-success" style="font-size: 1rem;">@funko.Price.ToString("C")</span>
                    </td>
                    <td class="align-middle">
                        <span class="badge bg-primary" style="font-size: 0.95rem;">@funko.Stock unidades</span>
                    </td>
                    <td class="align-middle">
                        <span class="badge bg-info">
                            <i class="bi bi-bookmark-fill"></i> @funko.Category.Name
                        </span>
                    </td>
                    <td class="align-middle">
                        <div class="d-flex gap-2 justify-content-center flex-wrap">
                            @if (User.IsInRole("Admin"))
                            {
                                <a class="btn btn-warning btn-sm"
                                   asp-action="Modificar" asp-route-id="@funko.Id">
                                    <i class="bi bi-pencil-fill"></i> Editar
                                </a>

                                <form asp-action="Delete"
                                      asp-route-id="@funko.Id" method="post" style="display:inline;">
                                    <button type="submit" class="btn btn-danger btn-sm"
                                            onclick="return confirm('¿Seguro que quieres borrar a @funko.Name?')">
                                        <i class="bi bi-trash-fill"></i> Borrar
                                    </button>
                                </form>
                            }

                            <a class="btn btn-info btn-sm"
                               asp-action="Details" asp-route-id="@funko.Id">
                                <i class="bi bi-eye-fill"></i> Detalles
                            </a>
                        </div>
                    </td>
                </tr>
            }
            </tbody>
        </table>
    </div>

    @if (!Model.Any())
    {
        <div class="text-center py-5">
            <div class="empty-state">
                <i class="bi bi-inbox" style="font-size: 4rem; color: #cbd5e0;"></i>
                <h3 class="mt-3 text-muted">No hay Funkos en tu colección</h3>
                <p class="text-muted">¡Comienza añadiendo tu primer Funko!</p>
                @if (User.IsInRole("Admin"))
                {
                    <a asp-action="Crear" class="btn btn-primary mt-3">
                        <i class="bi bi-plus-circle"></i> Añadir Primer Funko
                    </a>
                }
            </div>
        </div>
    }
</div>

<style>
    .funko-image-fondo {
        position: relative;
        display: inline-block;
    }
    
    .funko-image-wrapper {
        position: relative;
        display: inline-block;
    }
    
    .empty-state {
        padding: 3rem;
        background: white;
        border-radius: 15px;
        box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        animation: fadeIn 0.5s ease-out;
    }
    
    .lead {
        font-size: 1.1rem;
        font-weight: 400;
    }
</style>